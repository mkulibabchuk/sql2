SELECT g.name AS genre_name, COUNT(a.artist_id) AS artist_count
FROM genres g
JOIN artist_genres ag ON g.id = ag.genre_id
JOIN artists a ON ag.artist_id = a.id
GROUP BY g.name;

SELECT COUNT(t.id) AS track_count
FROM tracks t
JOIN albums a ON t.album_id = a.id
WHERE a.release_year BETWEEN 2019 AND 2020;

SELECT a.title AS album_title, AVG(t.duration) AS avg_duration
FROM albums a
JOIN tracks t ON a.id = t.album_id
GROUP BY a.title;

SELECT a.name
FROM artists a
LEFT JOIN artist_albums aa ON a.id = aa.artist_id
LEFT JOIN albums al ON aa.album_id = al.id
WHERE al.release_year != 2020 OR al.release_year IS NULL;

SELECT c.title
FROM compilations c
JOIN track_compilations tc ON c.id = tc.compilation_id
JOIN tracks t ON tc.track_id = t.id
JOIN albums a ON t.album_id = a.id
JOIN artist_albums aa ON a.id = aa.album_id
JOIN artists ar ON aa.artist_id = ar.id
WHERE ar.name = 'Queen';
